<Application x:Class="MVVM_Base.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:MVVM_Base.Common">
    <Application.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>

                <!-- スタイル類 -->
                <ResourceDictionary Source="Style/Page.xaml" />
                <ResourceDictionary Source="Style/ToggleButton.xaml" />
                <ResourceDictionary Source="Style/ToggleButtonIcon.xaml" />
                <ResourceDictionary Source="Style/ToggleButtonText.xaml" />
                <ResourceDictionary Source="Style/ButtonEnd.xaml" />
                <ResourceDictionary Source="Style/ButtonColorTheme.xaml" />

                <!-- テーマスロット経由で読み込む（構造は維持） -->
                <ResourceDictionary Source="Theme/DarkTheme.xaml" />

            </ResourceDictionary.MergedDictionaries>

            <!-- テーマスロットを「ポインタ」として残す -->
            <ResourceDictionary x:Key="ThemeResources">
                <ResourceDictionary.MergedDictionaries>
                    <ResourceDictionary Source="Theme/DarkTheme.xaml" />
                </ResourceDictionary.MergedDictionaries>
            </ResourceDictionary>

            <!-- デバッグ用フラグのコンバータ -->
            <local:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
            <local:NumericOnlyBehavior x:Key="NumericOnlyBehavior"/>
            <!--<local:StringToBooleanConverter x:Key="StringToBooleanConverter"/>-->

            <!-- 共通ボタンスタイル（ホバー・押下色だけ） -->
            <Style x:Key="HoverButtonStyle" TargetType="Button">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="border"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    Padding="2"
                                    CornerRadius="3">
                                <ContentPresenter HorizontalAlignment="Center"
                                      VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" 
                                        Value="True">
                                    <Setter TargetName="border" 
                                            Property="Background" 
                                            Value="{DynamicResource ButtonThemeColorBrush2}">
                                    </Setter>
                                </Trigger>
                                <Trigger Property="IsPressed" 
                                         Value="True">
                                    <Setter TargetName="border"
                                            Property="Background" 
                                            Value="{DynamicResource ButtonThemeColorBrush}">
                                    </Setter>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- ▼ GroupBox 共通スタイル -->
            <Style x:Key="GroupBoxStyle" TargetType="GroupBox">
                <Setter Property="Foreground" Value="{DynamicResource AccentBrush}"/>
                <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                <Setter Property="FontSize" Value="18"/>
                <Setter Property="FontWeight" Value="Bold"/>
                <Setter Property="Margin" Value="10"/>
                <Setter Property="Padding" Value="10"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="GroupBox">
                            <Border BorderBrush="{TemplateBinding BorderBrush}" 
                        BorderThickness="2" 
                        CornerRadius="5" 
                        Background="Transparent" 
                        SnapsToDevicePixels="True">
                                <DockPanel>
                                    <ContentPresenter x:Name="HeaderContent"
                                          ContentSource="Header" 
                                          RecognizesAccessKey="True"
                                          Margin="5"
                                          DockPanel.Dock="Top"/>
                                    <ContentPresenter Margin="{TemplateBinding Padding}"/>
                                </DockPanel>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- ▼ GroupBoxマージン小 共通スタイル -->
            <Style x:Key="GroupBoxSmallMarginStyle" TargetType="GroupBox">
                <Setter Property="Foreground" Value="{DynamicResource AccentBrush}"/>
                <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                <Setter Property="FontSize" Value="18"/>
                <Setter Property="FontWeight" Value="Bold"/>
                <Setter Property="Margin" Value="3"/>
                <Setter Property="Padding" Value="2"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="GroupBox">
                            <Border BorderBrush="{TemplateBinding BorderBrush}" 
                        BorderThickness="1" 
                        CornerRadius="5" 
                        Background="Transparent" 
                        SnapsToDevicePixels="True">

                                <DockPanel>
                                    <!-- ★ 下線つきヘッダーをテンプレートで差し替える -->
                                    <ContentPresenter x:Name="HeaderContent"
                                          ContentSource="Header" 
                                          RecognizesAccessKey="True"
                                          Margin="5"
                                          DockPanel.Dock="Top"
                                          ContentTemplate="{TemplateBinding HeaderTemplate}"/>

                                    <ContentPresenter Margin="{TemplateBinding Padding}"/>
                                </DockPanel>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- 枠線を細くした派生スタイル -->
            <Style x:Key="GroupBoxThinBorderStyle" TargetType="GroupBox" BasedOn="{StaticResource GroupBoxStyle}">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="GroupBox">
                            <Border BorderBrush="{TemplateBinding BorderBrush}" 
                BorderThickness="1"
                    CornerRadius="5" 
                Background="Transparent" 
                SnapsToDevicePixels="True">
                                <DockPanel>
                                    <ContentPresenter x:Name="HeaderContent"
                                  ContentSource="Header" 
                                  RecognizesAccessKey="True"
                                  Margin="5"
                                  DockPanel.Dock="Top"/>
                                    <ContentPresenter Margin="{TemplateBinding Padding}"/>
                                </DockPanel>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- ▼ StackPanel 共通スタイル -->
            <Style x:Key="VerticalStackPanelStyle" TargetType="StackPanel">
                <Setter Property="Orientation" Value="Vertical"/>
                <Setter Property="Width" Value="80"/>
                <Setter Property="Margin" Value="0,0,0,10"/>
            </Style>

            <!-- ▼ TextBlock 共通スタイル -->
            <Style x:Key="LabelTextStyle" TargetType="TextBlock">
                <Setter Property="Foreground" Value="{DynamicResource AccentBrush}"/>
                <Setter Property="FontSize" Value="{Binding LabelFontSize}"/>
                <Setter Property="FontWeight" Value="Medium"/>
            </Style>

            <!-- ▼ TextBox 共通スタイル -->
            <Style x:Key="InputTextBoxStyle" TargetType="TextBox">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                <Setter Property="BorderThickness" Value="0,0,0,1"/>
                <Setter Property="Margin" Value="0,0,0,5"/>
            </Style>

            <!-- ComboBoxItem用スタイル（ドロップダウンリスト内） -->
            <Style x:Key="UnderlineComboBoxItemStyle" TargetType="ComboBoxItem">
                <Setter Property="Foreground" Value="{DynamicResource AccentBrush}"/>
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="HorizontalContentAlignment" Value="Left"/>
                <Setter Property="VerticalContentAlignment" Value="Center"/>
                <Setter Property="Padding" Value="4,2"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ComboBoxItem">
                            <Border x:Name="Bd"
                Background="{TemplateBinding Background}"
                SnapsToDevicePixels="True">
                                <ContentPresenter 
                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <!-- ホバー時 -->
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Bd" Property="Background" Value="{DynamicResource ButtonThemeColorBrush2}"/>
                                    <Setter Property="Foreground" Value="{DynamicResource AccentBrush}"/>
                                </Trigger>
                                <!-- 選択時 -->
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter TargetName="Bd" Property="Background" Value="{DynamicResource ButtonThemeColorBrush}"/>
                                    <Setter Property="Foreground" Value="{DynamicResource AccentBrush}"/>
                                </Trigger>
                                <!-- 無効時 -->
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Foreground" Value="Gray"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- ComboBox用スタイル アンダーライン-->
            <Style x:Key="UnderlineComboBoxStyle" TargetType="ComboBox">
                <Setter Property="Foreground" Value="{DynamicResource AccentBrush}"/>
                <Setter Property="FontSize" Value="{Binding ComboFontSize}"/>
                <Setter Property="FontWeight" Value="Medium"/>
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                <Setter Property="BorderThickness" Value="0,0,0,1"/>
                <Setter Property="Padding" Value="0"/>
                <Setter Property="HorizontalContentAlignment" Value="Left"/>
                <Setter Property="VerticalContentAlignment" Value="Center"/>
                <Setter Property="Height" Value="{Binding ComboHeighSize}"/>
                <Setter Property="ItemContainerStyle" Value="{StaticResource UnderlineComboBoxItemStyle}"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ComboBox">
                            <Grid>
                                <!-- 下線ボーダー -->
                                <Border x:Name="Border"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    Background="{TemplateBinding Background}"
                    SnapsToDevicePixels="True"/>

                                <!-- 選択中のアイテム表示 -->
                                <ContentPresenter x:Name="ContentSite"
                              IsHitTestVisible="False"
                              Content="{TemplateBinding SelectionBoxItem}"
                              ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                              Margin="3,0,25,0"
                              VerticalAlignment="Center"
                              HorizontalAlignment="Left"/>

                                <!-- ドロップダウンボタン -->
                                <ToggleButton x:Name="DropDownToggle"
                                  Width="24" Height="20"
                                  Background="Transparent"
                                  HorizontalAlignment="Right"
                                  VerticalAlignment="Center"
                                  IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Cursor="">
                                    <ToggleButton.Style>
                                        <Style TargetType="ToggleButton">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                            <Setter Property="BorderThickness" Value="1"/>
                                            <Setter Property="Padding" Value="5"/>
                                            <Setter Property="Cursor" Value="Hand"/>

                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="ToggleButton">
                                                        <Border x:Name="border"
                                                    Background="{TemplateBinding Background}"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    CornerRadius="4">
                                                            <ContentPresenter HorizontalAlignment="Center"
                                                                  VerticalAlignment="Center"/>
                                                        </Border>

                                                        <ControlTemplate.Triggers>
                                                            <!-- ホバー時 -->
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter TargetName="border" Property="Background" Value="{DynamicResource ButtonThemeColorBrush2}"/>
                                                            </Trigger>

                                                            <!-- 押下時 -->
                                                            <Trigger Property="IsPressed" Value="True">
                                                                <Setter TargetName="border" Property="Background" Value="{DynamicResource ButtonThemeColorBrush}"/>
                                                            </Trigger>

                                                            <!-- チェック時 -->
                                                            <Trigger Property="IsChecked" Value="True">
                                                                <Setter TargetName="border" Property="Background" Value="{DynamicResource ButtonThemeColorBrush}"/>
                                                            </Trigger>
                                                        </ControlTemplate.Triggers>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </ToggleButton.Style>
                                    <!-- ドロップダウンアイコン -->
                                    <Path Data="M 0 0 L 4 4 L 8 0 Z"
                              Fill="{TemplateBinding Foreground}"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center">
                                    </Path>
                                </ToggleButton>

                                <!-- ドロップダウンリスト -->
                                <Popup x:Name="Popup"
                           Placement="Bottom"
                           IsOpen="{TemplateBinding IsDropDownOpen}"
                           AllowsTransparency="True"
                           Focusable="False"
                           PopupAnimation="Slide">

                                    <Grid Name="DropDown"
                              SnapsToDevicePixels="True"
                              MinWidth="{TemplateBinding ActualWidth}"
                              MaxHeight="{TemplateBinding MaxDropDownHeight}">

                                        <Border x:Name="DropDownBorder"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="1"
                                    Background="{DynamicResource LeftWindowColor2Brush}"/>

                                        <ScrollViewer Margin="4,6,4,6" SnapsToDevicePixels="True">
                                            <ItemsPresenter />
                                        </ScrollViewer>
                                    </Grid>
                                </Popup>

                            </Grid>

                            <!-- トリガー -->
                            <ControlTemplate.Triggers>
                                <Trigger Property="HasItems" Value="False">
                                    <Setter TargetName="DropDownBorder" Property="MinHeight" Value="95"/>
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Foreground" Value="Gray"/>
                                </Trigger>
                                <Trigger Property="IsGrouping" Value="True">
                                    <Setter Property="ScrollViewer.CanContentScroll" Value="False"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- Entry画面のMFCステータスラジオボタン-->
            <Style x:Key="StatusRadioButtonStyle" TargetType="RadioButton">
                <!-- 共通プロパティ -->
                <Setter Property="Foreground" Value="{DynamicResource AccentBrush}"/>
                <Setter Property="FontSize" Value="{Binding StatusFontSize}"/>
                <Setter Property="VerticalContentAlignment" Value="Center"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="RadioButton">
                            <Border x:Name="Border" Background="Transparent" CornerRadius="3" Padding="3">
                                <StackPanel Orientation="Horizontal">
                                    <!-- チェックマーク部分 -->
                                    <Ellipse x:Name="Bullet"
                                                     Width="{Binding RadioBtnSIze}" 
                                                     Height="{Binding RadioBtnSIze}"
                                                     Stroke="{DynamicResource TagColorBrush}"
                                                     StrokeThickness="1"
                                                     Fill="Transparent"
                                                     Margin="0,0,5,0">
                                        <Ellipse.Effect>
                                            <DropShadowEffect x:Name="BulletShadow"
                                                                Color="{DynamicResource TagColor}"
                                                                BlurRadius="{Binding RadioBtnBloomSIze}"
                                                                ShadowDepth="0"
                                                                Opacity="0"/>
                                        </Ellipse.Effect>
                                    </Ellipse>

                                    <!-- テキスト部分 -->
                                    <ContentPresenter VerticalAlignment="Center" RecognizesAccessKey="True"/>
                                </StackPanel>
                            </Border>

                            <ControlTemplate.Triggers>
                                <!-- チェック時 -->
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter TargetName="Bullet" Property="Fill" Value="{DynamicResource TagColorBrush}"/>
                                    <Trigger.EnterActions>
                                        <BeginStoryboard Name="BlinkStoryboard">
                                            <Storyboard RepeatBehavior="Forever" AutoReverse="True">
                                                <DoubleAnimation
                                                    Storyboard.TargetName="BulletShadow"
                                                    Storyboard.TargetProperty="Opacity"
                                                    From="0.3" To="1.0"
                                                    Duration="0:0:2"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.EnterActions>
                                    <Trigger.ExitActions>
                                        <StopStoryboard BeginStoryboardName="BlinkStoryboard"/>
                                    </Trigger.ExitActions>
                                </Trigger>

                                <!-- ホバー時 -->
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Border" Property="Background" Value="{DynamicResource ButtonThemeColorBrush}"/>
                                </Trigger>

                                <!-- 無効化 -->
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Foreground" Value="Gray"/>
                                    <Setter TargetName="Bullet" Property="Stroke" Value="Gray"/>
                                    <Setter TargetName="Bullet" Property="Fill" Value="Transparent"/>
                                    <Setter TargetName="Bullet" Property="Effect">
                                        <Setter.Value>
                                            <DropShadowEffect Color="{DynamicResource TagColor}" BlurRadius="6" ShadowDepth="0" Opacity="0"/>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- 共通 ScrollBar スタイル -->
            <Style TargetType="ScrollBar">
                <Setter Property="Background" Value="{DynamicResource LeftWindowColor2Brush}"/>
                <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ScrollBar">
                            <Grid>
                                <!-- 背景 -->
                                <Border Background="{TemplateBinding Background}" 
                                    BorderBrush="{TemplateBinding BorderBrush}" 
                                    BorderThickness="{TemplateBinding BorderThickness}"/>

                                <Track x:Name="PART_Track" Orientation="{TemplateBinding Orientation}">
                                    <Track.Thumb>
                                        <Thumb Background="{TemplateBinding Background}" 
                                           BorderBrush="{TemplateBinding BorderBrush}" 
                                           BorderThickness="{TemplateBinding BorderThickness}"/>
                                    </Track.Thumb>
                                </Track>
                            </Grid>

                            <ControlTemplate.Triggers>
                                <Trigger Property="Orientation" Value="Vertical">
                                    <Setter TargetName="PART_Track" Property="IsDirectionReversed" Value="true"/>
                                </Trigger>
                                <Trigger Property="Orientation" Value="Horizontal">
                                    <Setter TargetName="PART_Track" Property="IsDirectionReversed" Value="false"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="UnderlineTextBoxStyle" TargetType="TextBox">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Foreground" Value="{DynamicResource AccentBrush}"/>
                <Setter Property="Padding" Value="0"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="TextBox">
                            <Grid>
                                <!-- 背景（通常 = Transparent）-->
                                <Border x:Name="BgBorder"
                                        Margin="5"
                                        Background="Transparent"
                                        Padding="{TemplateBinding Padding}">
                                    <ScrollViewer x:Name="PART_ContentHost"/>
                                </Border>

                                <!-- 下線（通常 = AccentBrush）-->
                                <Border x:Name="Underline"
                                        Height="1.5"
                                        Margin="5 0 5 5"
                                        Background="{DynamicResource AccentBrush}"
                                        VerticalAlignment="Bottom"/>
                            </Grid>

                            <!-- フォーカス時の色変更 -->
                            <ControlTemplate.Triggers>
                                <!-- TextBoxがフォーカス中 -->
                                <Trigger Property="IsKeyboardFocused" Value="True">
                                    <!-- 下線色変更 -->
                                    <Setter TargetName="Underline"
                                            Property="Background"
                                            Value="{DynamicResource TagColorBrush}" />
                                    <!-- 背景色変更 -->
                                    <Setter TargetName="BgBorder"
                                            Property="Background"
                                            Value="{DynamicResource ButtonThemeColorBrush2}" />
                                </Trigger>
                            </ControlTemplate.Triggers>

                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>


            <!-- セル：背景透明＋上下左右に罫線 -->
            <Style x:Key="TransparentCell" TargetType="DataGridCell">
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="Foreground" Value="{DynamicResource AccentBrush}" />
                <Setter Property="BorderThickness" Value="0" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="DataGridCell">
                            <Border x:Name="Bd"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{DynamicResource ButtonThemeColorBrush}"
                                    BorderThickness="1">
                                <!-- 四辺すべて -->
                                <ContentPresenter
                                    Margin="0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"/>
                            </Border>

                            <ControlTemplate.Triggers>
                                <!-- 選択時 -->
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter TargetName="Bd"
                                            Property="Background"
                                            Value="{DynamicResource ButtonThemeColorBrush}" />
                                    <!--<Setter Property="Foreground" Value="White"/>-->
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- カラムヘッダ：背景透明＋四辺罫線 -->
            <Style x:Key="TransparentColumnHeader" TargetType="DataGridColumnHeader">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="Foreground" Value="{DynamicResource AccentBrush}" />
                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                <Setter Property="BorderThickness" Value="0"/>

                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="DataGridColumnHeader">
                            <Border x:Name="Hd"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{DynamicResource ButtonThemeColorBrush}"
                                    BorderThickness="1">
                                <ContentPresenter Margin="0"
                                      VerticalAlignment="Center"
                                      HorizontalAlignment="Center"/>
                            </Border>

                            <ControlTemplate.Triggers>
                                <!-- ソート時の色変更を無効化したいならコメントで残す -->
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>


            <!-- 編集時 TextBox の背景色 -->
            <Style x:Key="EditingTextBoxStyle" TargetType="TextBox">
                <Setter Property="Background" Value="{DynamicResource ButtonThemeColorBrush2}" />
                <Setter Property="BorderThickness" Value="0" />
                <Setter Property="FontSize" Value="{Binding DataGridFontSize}" />
            </Style>

            <!-- 11行出力のひな形 -->
            <ItemsPanelTemplate x:Key="11RowGridPanel">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                </Grid>
            </ItemsPanelTemplate>

            <!--  -->
            <Style x:Key="MeasureTextCenterStyle" TargetType="TextBlock">
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="HorizontalAlignment" Value="Center"/>
                <Setter Property="VerticalAlignment" Value="Center"/>
            </Style>

            <Style x:Key="MeasureTextLeftStyle"
                    TargetType="TextBlock"
                    BasedOn="{StaticResource MeasureTextCenterStyle}">
                <Setter Property="HorizontalAlignment" Value="Left"/>
                <Setter Property="Margin" Value="4,0,0,0"/>
            </Style>

            <Style x:Key="MeasureCellBorderStyle" TargetType="Border">
                <Setter Property="BorderBrush" Value="{DynamicResource ButtonThemeColorBrush}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="Background" Value="Transparent" />

                <Style.Triggers>
                    <!-- 1行目（AlternationIndex == 0） -->
                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=ContentPresenter},
                                       Path=(ItemsControl.AlternationIndex)}"
                                Value="0">
                        <Setter Property="BorderBrush" Value="{DynamicResource ButtonThemeColorBrush2}" />
                    </DataTrigger>
                </Style.Triggers>
            </Style>

            <!-- 共通ボタンスタイル（ホバー・押下色だけ） -->
            <Style x:Key="ConfirmButtonStyle" TargetType="Button">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="border"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}">
                                <ContentPresenter HorizontalAlignment="Center"
                                      VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" 
                                        Value="True">
                                    <Setter TargetName="border" 
                                            Property="Background" 
                                            Value="{DynamicResource ButtonThemeColorBrush2}">
                                    </Setter>
                                </Trigger>
                                <Trigger Property="IsPressed" 
                                         Value="True">
                                    <Setter TargetName="border"
                                            Property="Background" 
                                            Value="{DynamicResource ButtonThemeColorBrush}">
                                    </Setter>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

        </ResourceDictionary>
    </Application.Resources>
</Application>
